import{_ as t,c as i,a3 as s,o as a}from"./chunks/framework.BA2tfOtD.js";const k=JSON.parse('{"title":"Rollkit Metrics Guide","description":"","frontmatter":{"head":[["meta",{"name":"og:title","content":"Rollkit Metrics Guide | Rollkit"},{"name":"og:description","content":false}]]},"headers":[],"relativePath":"guides/metrics.md","filePath":"guides/metrics.md","lastUpdated":1747148394000}'),n={name:"guides/metrics.md"};function r(l,e,d,o,h,c){return a(),i("div",null,e[0]||(e[0]=[s(`<h1 id="rollkit-metrics-guide" tabindex="-1">Rollkit Metrics Guide <a class="header-anchor" href="#rollkit-metrics-guide" aria-label="Permalink to &quot;Rollkit Metrics Guide&quot;">​</a></h1><h2 id="how-to-configure-metrics" tabindex="-1">How to configure metrics <a class="header-anchor" href="#how-to-configure-metrics" aria-label="Permalink to &quot;How to configure metrics&quot;">​</a></h2><p>Rollkit can report and serve Prometheus metrics, which can be consumed by Prometheus collector(s).</p><p>This functionality is disabled by default.</p><p>To enable Prometheus metrics, set <code>instrumentation.prometheus=true</code> in your Rollkit node&#39;s configuration file.</p><p>Metrics will be served under <code>/metrics</code> on port 26660 by default. The listening address can be changed using the <code>instrumentation.prometheus_listen_addr</code> configuration option.</p><h2 id="list-of-available-metrics" tabindex="-1">List of available metrics <a class="header-anchor" href="#list-of-available-metrics" aria-label="Permalink to &quot;List of available metrics&quot;">​</a></h2><p>The following metrics are available, grouped by their subsystem:</p><h3 id="block-manager" tabindex="-1">Block Manager <a class="header-anchor" href="#block-manager" aria-label="Permalink to &quot;Block Manager&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Name</th><th>Type</th><th>Tags</th><th>Description</th></tr></thead><tbody><tr><td><code>rollkit_sequencer_height</code></td><td>Gauge</td><td>chain_id</td><td>Height of the chain</td></tr><tr><td><code>rollkit_sequencer_num_txs</code></td><td>Gauge</td><td>chain_id</td><td>Number of transactions</td></tr><tr><td><code>rollkit_sequencer_block_size_bytes</code></td><td>Gauge</td><td>chain_id</td><td>Size of the block</td></tr><tr><td><code>rollkit_sequencer_total_txs</code></td><td>Gauge</td><td>chain_id</td><td>Total number of transactions</td></tr><tr><td><code>rollkit_sequencer_latest_block_height</code></td><td>Gauge</td><td>chain_id</td><td>The latest block height</td></tr></tbody></table><h3 id="p2p" tabindex="-1">P2P <a class="header-anchor" href="#p2p" aria-label="Permalink to &quot;P2P&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Name</th><th>Type</th><th>Tags</th><th>Description</th></tr></thead><tbody><tr><td><code>rollkit_p2p_peers</code></td><td>Gauge</td><td>chain_id</td><td>Number of connected peers</td></tr><tr><td><code>rollkit_p2p_peer_receive_bytes_total</code></td><td>Counter</td><td>peer_id, chID</td><td>Number of bytes received from a given peer</td></tr><tr><td><code>rollkit_p2p_peer_send_bytes_total</code></td><td>Counter</td><td>peer_id, chID</td><td>Number of bytes sent to a given peer</td></tr><tr><td><code>rollkit_p2p_peer_pending_send_bytes</code></td><td>Gauge</td><td>peer_id</td><td>Pending bytes to be sent to a given peer</td></tr><tr><td><code>rollkit_p2p_num_txs</code></td><td>Gauge</td><td>peer_id</td><td>Number of transactions submitted by each peer</td></tr><tr><td><code>rollkit_p2p_message_receive_bytes_total</code></td><td>Counter</td><td>message_type</td><td>Number of bytes of each message type received</td></tr><tr><td><code>rollkit_p2p_message_send_bytes_total</code></td><td>Counter</td><td>message_type</td><td>Number of bytes of each message type sent</td></tr></tbody></table><p>In addition to these, <a href="https://github.com/libp2p/go-libp2p/tree/master/dashboards" target="_blank" rel="noreferrer">go-libp2p metrics</a> are exported as well.</p><h3 id="single-sequencer" tabindex="-1">Single Sequencer <a class="header-anchor" href="#single-sequencer" aria-label="Permalink to &quot;Single Sequencer&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Name</th><th>Type</th><th>Tags</th><th>Description</th></tr></thead><tbody><tr><td><code>sequencer_gas_price</code></td><td>Gauge</td><td>chain_id</td><td>The gas price of DA</td></tr><tr><td><code>sequencer_last_blob_size</code></td><td>Gauge</td><td>chain_id</td><td>The size in bytes of the last DA blob</td></tr><tr><td><code>sequencer_transaction_status</code></td><td>Counter</td><td>chain_id, status</td><td>Count of transaction statuses for DA submissions</td></tr><tr><td><code>sequencer_num_pending_blocks</code></td><td>Gauge</td><td>chain_id</td><td>The number of pending blocks for DA submission</td></tr><tr><td><code>sequencer_included_block_height</code></td><td>Gauge</td><td>chain_id</td><td>The last DA included block height</td></tr></tbody></table><h3 id="based-sequencer" tabindex="-1">Based Sequencer <a class="header-anchor" href="#based-sequencer" aria-label="Permalink to &quot;Based Sequencer&quot;">​</a></h3><p>The Based Sequencer uses the same metrics as the Single Sequencer, with additional metrics related to the based DA layer.</p><h2 id="viewing-metrics" tabindex="-1">Viewing Metrics <a class="header-anchor" href="#viewing-metrics" aria-label="Permalink to &quot;Viewing Metrics&quot;">​</a></h2><p>Once your Rollkit node is running with metrics enabled, you can view the metrics by:</p><ol><li><p>Accessing the metrics endpoint directly:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>curl http://localhost:26660/metrics</span></span></code></pre></div></li><li><p>Configuring Prometheus to scrape these metrics by adding the following to your <code>prometheus.yml</code>:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scrape_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">job_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rollkit</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    static_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;localhost:26660&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li><li><p>Using Grafana with Prometheus as a data source to visualize the metrics.</p></li></ol><h2 id="example-prometheus-configuration" tabindex="-1">Example Prometheus Configuration <a class="header-anchor" href="#example-prometheus-configuration" aria-label="Permalink to &quot;Example Prometheus Configuration&quot;">​</a></h2><p>Here&#39;s a basic Prometheus configuration to scrape metrics from a Rollkit node:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  scrape_interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">15s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  evaluation_interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">15s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scrape_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">job_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rollkit</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    static_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;localhost:26660&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><p>If you&#39;re not seeing metrics:</p><ol><li>Ensure metrics are enabled in your configuration with <code>instrumentation.prometheus=true</code></li><li>Verify the metrics endpoint is accessible: <code>curl http://localhost:26660/metrics</code></li><li>Check your Prometheus configuration is correctly pointing to your Rollkit node</li><li>Examine the Rollkit node logs for any errors related to the metrics server</li></ol><h2 id="advanced-configuration" tabindex="-1">Advanced Configuration <a class="header-anchor" href="#advanced-configuration" aria-label="Permalink to &quot;Advanced Configuration&quot;">​</a></h2><p>For more advanced metrics configuration, you can adjust the following settings in your configuration file:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">instrumentation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  prometheus_listen_addr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;:26660&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  max_open_connections</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;rollkit&quot;</span></span></code></pre></div><p>These settings allow you to:</p><ul><li>Enable/disable Prometheus metrics</li><li>Change the listening address for the metrics server</li><li>Limit the maximum number of open connections to the metrics server</li><li>Set a custom namespace for all metrics</li></ul>`,31)]))}const u=t(n,[["render",r]]);export{k as __pageData,u as default};
