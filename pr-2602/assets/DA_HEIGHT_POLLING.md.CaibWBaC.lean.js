import{_ as i,c as s,ag as e,o as t}from"./chunks/framework.Cp03Q4Ms.js";const k=JSON.parse('{"title":"DA Height Polling for Genesis Initialization","description":"","frontmatter":{"head":[["meta",{"name":"og:title","content":"DA Height Polling for Genesis Initialization | Evolve"},{"name":"og:description","content":false}]]},"headers":[],"relativePath":"DA_HEIGHT_POLLING.md","filePath":"DA_HEIGHT_POLLING.md","lastUpdated":1756116929000}'),n={name:"DA_HEIGHT_POLLING.md"};function o(l,a,r,h,g,p){return t(),s("div",null,a[0]||(a[0]=[e(`<h1 id="da-height-polling-for-genesis-initialization" tabindex="-1">DA Height Polling for Genesis Initialization <a class="header-anchor" href="#da-height-polling-for-genesis-initialization" aria-label="Permalink to &quot;DA Height Polling for Genesis Initialization&quot;">​</a></h1><p>This feature allows non-aggregator nodes to automatically poll the DA (Data Availability) height from an aggregator node during genesis initialization, eliminating the need to manually configure the DA start height.</p><h2 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">​</a></h2><p>When a non-aggregator node starts with a genesis configuration where <code>genesis_da_start_height</code> is zero (or equivalently, <code>GenesisDAStartTime</code> is zero time), it will automatically poll the configured aggregator endpoint to get the current DA height before proceeding with chain initialization.</p><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h2><h3 id="for-non-aggregator-nodes" tabindex="-1">For Non-Aggregator Nodes <a class="header-anchor" href="#for-non-aggregator-nodes" aria-label="Permalink to &quot;For Non-Aggregator Nodes&quot;">​</a></h3><p>Add the aggregator endpoint to your configuration:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">da</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  aggregator_endpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://aggregator-node:7331</span></span></code></pre></div><p>Or via command line:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">evnode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --evnode.da.aggregator_endpoint=http://aggregator-node:7331</span></span></code></pre></div><h3 id="for-aggregator-nodes" tabindex="-1">For Aggregator Nodes <a class="header-anchor" href="#for-aggregator-nodes" aria-label="Permalink to &quot;For Aggregator Nodes&quot;">​</a></h3><p>No additional configuration needed. Aggregator nodes automatically expose the <code>/da/height</code> endpoint when DA visualization is enabled.</p><h2 id="genesis-file-setup" tabindex="-1">Genesis File Setup <a class="header-anchor" href="#genesis-file-setup" aria-label="Permalink to &quot;Genesis File Setup&quot;">​</a></h2><p>For non-aggregator nodes to trigger automatic DA height polling, the genesis file should have a zero DA start time:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;chain_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my-chain&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;genesis_da_start_height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1970-01-01T00:00:00Z&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;initial_height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;proposer_address&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="workflow-example" tabindex="-1">Workflow Example <a class="header-anchor" href="#workflow-example" aria-label="Permalink to &quot;Workflow Example&quot;">​</a></h2><ol><li><p><strong>Aggregator Node Setup:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Start an aggregator node</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">evnode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --evnode.node.aggregator</span></span></code></pre></div></li><li><p><strong>Non-Aggregator Node Setup:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Initialize non-aggregator node with aggregator endpoint</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">evnode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --evnode.da.aggregator_endpoint=http://aggregator:7331</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Start non-aggregator node (will automatically poll DA height)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">evnode</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span></code></pre></div></li></ol><h2 id="api-endpoint" tabindex="-1">API Endpoint <a class="header-anchor" href="#api-endpoint" aria-label="Permalink to &quot;API Endpoint&quot;">​</a></h2><p>Aggregator nodes expose the following endpoint:</p><p><strong>GET <code>/da/height</code></strong></p><p>Returns the current DA layer height:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1234</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2023-11-15T10:30:15Z&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="polling-behavior" tabindex="-1">Polling Behavior <a class="header-anchor" href="#polling-behavior" aria-label="Permalink to &quot;Polling Behavior&quot;">​</a></h2><ul><li><strong>Timeout:</strong> 5 minutes maximum</li><li><strong>Interval:</strong> 5 seconds between polls</li><li><strong>Condition:</strong> Only triggers when <code>genesis_da_start_height</code> is zero and node is not an aggregator</li><li><strong>Fallback:</strong> If no aggregator endpoint is configured, uses current time</li></ul><h2 id="error-handling" tabindex="-1">Error Handling <a class="header-anchor" href="#error-handling" aria-label="Permalink to &quot;Error Handling&quot;">​</a></h2><p>If the polling fails:</p><ul><li>The node will log the error and fail to start</li><li>Check that the aggregator endpoint is reachable</li><li>Verify the aggregator node has the DA height endpoint available</li><li>Ensure the aggregator node is running and has advanced beyond height 0</li></ul><h2 id="use-cases" tabindex="-1">Use Cases <a class="header-anchor" href="#use-cases" aria-label="Permalink to &quot;Use Cases&quot;">​</a></h2><ul><li><strong>Simplified Deployment:</strong> No need to manually coordinate DA start heights</li><li><strong>Dynamic Chain Launching:</strong> Non-aggregator nodes can join automatically</li><li><strong>Development Testing:</strong> Easy setup for multi-node test networks</li></ul>`,29)]))}const c=i(n,[["render",o]]);export{k as __pageData,c as default};
